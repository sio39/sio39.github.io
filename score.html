<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>スプレッドシート読み込み</title>
<style>
body{
    background:#0b0e14;
    color:#e8edf7;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;
    padding:20px;
}
table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}
th, td{
    border:1px solid #444;
    padding:8px;
}
th{
    background:#121722;
    color:#4da3ff;
}
tr:nth-child(even){
    background:#1a1f2b;
}
</style>
</head>
<body>

<h1>Google スプレッドシートから読み込む表</h1>

<table id="sheet-table">
  <thead>
    <tr>
      <th>銘柄名</th>
      <th>銘柄コード</th>
      <th>AIスコア</th>
      <th>A3スコア</th>
      <th>価格</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
// Google Sheets を CSV 形式で取得するURL
const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTfc-cWPkuFopkiD3PD-6zhBTg40I6U5mxseKReyVEZCBCFhuZeworPmefDQwZit7zAWP-mlX2YLo3r/pub?output=csv';

Papa.parse(csvUrl, {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function(results){
        const tbody = document.querySelector('#sheet-table tbody');

        results.data.forEach(row => {
            // 空行をスキップ
            if(!row['銘柄名']) return;
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${row['銘柄名']}</td>
                <td>${row['銘柄コード']}</td>
                <td>${row['AIスコア']}</td>
                <td>${row['A3スコア']}</td>
                <td>${row['価格']}</td>
            `;
            tbody.appendChild(tr);
        });
    },
    error: function(err){
        console.error('CSV読み込みエラー:', err);
        document.querySelector('#sheet-table tbody').innerHTML = '<tr><td colspan="5">読み込みエラー</td></tr>';
    }
});
</script>

</body>
</html>
